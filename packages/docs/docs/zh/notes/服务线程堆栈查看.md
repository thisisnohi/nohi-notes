# 服务线程堆栈查看

​		列举说明查看线程堆栈常用方法、命令

## 查看进程 获取pid

* jps:

  ```
  nohi$ jps
  46020 Jps
  45957 jar
  ```

* ps -ef | grep java

  ```
  nohi$ ps -ef | grep java
    501 46027  1671   0 10:41上午 ttys000    0:00.00 grep java
    501 45957 80687   0 10:37上午 ttys001    0:00.51 /usr/bin/java -jar arthas-demo.jar
  
  46027 45957 为pid
  ```

  

## 打印堆栈

* kill -3 pid

注：

​	 需要进程以nohup 方式启动，kill -3 后会在jar所生成的nohup.out文件中（一般在jar同目录）





## 查看、备份

* tail -n 10000 nohup.out > 1.txt

  nohup.out 最后1w行数据存储到1.txt文件中备份

问题定位：

​	查看nohup.out/1.txt文件，从尾部向上查看

​    一般如果是代码逻辑问题，卡某个方法，会找到方法执行的堆栈（业务逻辑代码），即可定位问题



## 其它

* 工具：arthas
  * 参考：https://alibaba.github.io/arthas/
  * thread -b 查看线程死锁